<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>San Andreas Aviation Administration</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      background: #f4f8ff;
      color: #1b1e21;
      font-family: "Segoe UI", sans-serif;
      margin: 0;
    }

    nav.navbar {
      background-color: #003366 !important;
    }
    .navbar-brand, .nav-link {
      color: #d1e8ff !important;
    }
    .nav-link:hover {
      color: #ffe57f !important;
      text-decoration: underline;
    }

    section {
      padding: 40px 20px;
      max-width: 1000px;
      margin: auto;
      display: none;
    }

    section.active {
      display: block;
    }

    .card {
      background-color: white;
      border-radius: 12px;
      box-shadow: 0 2px 12px #00000011;
    }

    .notice-item {
      background: #e8f1ff;
      border: 1px solid #b0d1ff;
      padding: 16px;
      margin-bottom: 12px;
      border-radius: 10px;
    }
    .notice-item strong {
      color: #003366;
    }

    .list-group-item {
      background: transparent;
      border: none;
      color: #003366;
    }

    footer {
      text-align: center;
      padding: 20px;
      color: #a9c9df;
      background-color: #003366;
    }

    /* Airport Status Table */
    #statusTable table {
      width: 100%;
      border-collapse: collapse;
      text-align: center;
      background-color: #ffffff;
      border: 1px solid #3f719f;
      border-radius: 10px;
      overflow: hidden;
    }

    #statusTable th, #statusTable td {
      padding: 12px 15px;
      border: 1px solid #d3e8ff;
      text-align: center;
      vertical-align: middle;
    }

    #statusTable th {
      background-color: #003e72;
      color: #ffffff;
    }

    #statusTable td {
      background-color: #eaf3fc;
      color: #003355;
      font-weight: 600;
    }

    iframe {
      border: none;
      background: #f0f7ff;
      padding: 10px;
      border-radius: 8px;
    }
  </style>
</head>
<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container">
      <a class="navbar-brand" href="#">San Andreas Aviation Administration</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#menuNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="menuNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" data-page="home" href="#">Home</a></li>
          <li class="nav-item"><a class="nav-link" data-page="notice" href="#">Notice Board</a></li>
          <li class="nav-item"><a class="nav-link" data-page="mechanic" href="#">Mechanic Form</a></li>
          <li class="nav-item"><a class="nav-link" data-page="flightlog" href="#">Flight Log</a></li>
          <li class="nav-item"><a class="nav-link" data-page="infodesk" href="#">Info Desk</a></li>
          <li class="nav-item"><a class="nav-link" data-page="inq" href="#">Inquiries</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- üè† Home -->
  <section id="home" class="active">
    <div class="text-center mb-4">
      <h1>üõ´ Welcome to the San Andreas Aviation Administration</h1>
      <p>This public portal provides access to training programs, airport status, licenses, and more.</p>
    </div>

    <div class="card shadow mb-4">
      <div class="card-header bg-primary text-white">
        <h5 class="mb-0">üõ¨ Airport Status Board</h5>
      </div>
      <div class="card-body" id="statusTable">Loading airport status‚Ä¶</div>
    </div>

    <div class="card shadow mb-4">
      <div class="card-header bg-danger text-white">
        <h5 class="mb-0">‚ö†Ô∏è Notice Board</h5>
      </div>
      <div class="card-body" id="noticeArea">Loading notices‚Ä¶</div>
    </div>

    <div class="card shadow">
      <div class="card-header bg-success text-white">
        <h5 class="mb-0">üõ©Ô∏è Current Trainings</h5>
      </div>
      <div class="card-body" id="TrainingArea">Loading trainings‚Ä¶</div>
    </div>
  </section>

  <!-- üõ†Ô∏è Mechanic Form -->
  <section id="mechanic">
    <h2>üõ†Ô∏è Mechanic Modification Form</h2>
    <p>Submit aircraft structural or technical modifications below:</p>
    <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSe_qSH6rQGnxNW-O6NZm9gU-vPutKfclz2Y8koC8enhtRfqDQ/viewform?embedded=true" height="800" width="1000"></iframe>
  </section>

  <!-- üìò Notice Board Page -->
  <section id="notice">
    <h2>üö´ Full Notice Board</h2>
    <div id="noticeArea2">Loading notices‚Ä¶</div>

    <h2>üõ©Ô∏è Full Training Log</h2>
    <div id="TrainingArea2">Loading training info‚Ä¶</div>
  </section>

  <!-- ‚úàÔ∏è Flight Log -->
  <section id="flightlog">
  <div class="card shadow" style="background: linear-gradient(135deg, #091f62, #003399); color: white;">
    <div class="card-header text-center">
    <h2>üìù Flight Log Generator</h2>
    </div>
    <div class="card-body">
      <form id="flightInfoForm" autocomplete="off" novalidate>
        <!-- Date -->
        <div class="mb-3 row align-items-center">
          <label for="flightDate" class="col-sm-4 col-form-label fw-bold text-end">Date:</label>
          <div class="col-sm-8">
            <input type="date" id="flightDate" class="form-control" required />
          </div>
        </div>
        <!-- Aircraft Tail Number or Callsign -->
        <div class="mb-3 row align-items-center">
          <label for="tailNumber" class="col-sm-4 col-form-label fw-bold text-end">Aircraft Tail Number or Callsign:</label>
          <div class="col-sm-8">
            <input type="text" id="tailNumber" class="form-control" required />
          </div>
        </div>
        <!-- Passenger List -->
        <div class="mb-3 row align-items-center">
          <label for="passengerList" class="col-sm-4 col-form-label fw-bold text-end">Passenger List:</label>
          <div class="col-sm-8">
            <input type="text" id="passengerList" class="form-control" required />
          </div>
        </div>
        <!-- Departure Time -->
        <div class="mb-3 row align-items-center">
          <label for="departureTime" class="col-sm-4 col-form-label fw-bold text-end">Departure Time (UTC):</label>
          <div class="col-sm-8">
            <input type="text" id="departureTime" class="form-control" required />
          </div>
        </div>
        <!-- Departure Location -->
        <div class="mb-3 row align-items-center">
          <label for="departureLocation" class="col-sm-4 col-form-label fw-bold text-end">Departure Location:</label>
          <div class="col-sm-8">
            <input type="text" id="departureLocation" class="form-control" required />
          </div>
        </div>
        <!-- Intermittent Locations -->
        <div class="mb-3 row align-items-center">
          <label for="intermittentLocations" class="col-sm-4 col-form-label fw-bold text-end">Intermittent Locations:</label>
          <div class="col-sm-8">
            <input type="text" id="intermittentLocations" class="form-control" required />
          </div>
        </div>
        <!-- Arrival Location -->
        <div class="mb-3 row align-items-center">
          <label for="arrivalLocation" class="col-sm-4 col-form-label fw-bold text-end">Arrival Location:</label>
          <div class="col-sm-8">
            <input type="text" id="arrivalLocation" class="form-control" required />
          </div>
        </div>
        <!-- Cruise Altitude -->
        <div class="mb-3 row align-items-center">
          <label for="cruiseAltitude" class="col-sm-4 col-form-label fw-bold text-end">Cruise Altitude (Feet):</label>
          <div class="col-sm-8">
            <input type="text" id="cruiseAltitude" class="form-control" required />
          </div>
        </div>
        <!-- Total Flight Time -->
        <div class="mb-3 row align-items-center">
          <label for="flightTime" class="col-sm-4 col-form-label fw-bold text-end">Total Flight Time:</label>
          <div class="col-sm-8">
            <input type="text" id="flightTime" class="form-control" placeholder="e.g. 90 Minutes or 1.5 Hours" required />
          </div>
        </div>
        <!-- Emergency Reported -->
        <div class="mb-3 row align-items-center">
          <label class="col-sm-4 col-form-label fw-bold text-end">Emergency Reported:</label>
          <div class="col-sm-8 d-flex gap-3">
            <div class="form-check">
              <input class="form-check-input" type="radio" name="emergency" id="emergencyYes" value="Yes" required>
              <label class="form-check-label" for="emergencyYes">Yes</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="emergency" id="emergencyNo" value="No" required>
              <label class="form-check-label" for="emergencyNo">No</label>
            </div>
          </div>
        </div>
        <!-- Emergency Section -->
        <div id="emergencySection" style="display:none;">
          <div class="mb-3 row align-items-center">
            <label for="emergencyType" class="col-sm-4 col-form-label fw-bold text-end">Type Of Emergency:</label>
            <div class="col-sm-8">
              <input type="text" id="emergencyType" class="form-control" placeholder="e.g. Engine Failure, Fuel Leak" />
            </div>
          </div>
          <div class="mb-3 row align-items-center">
            <label for="emergencyLocation" class="col-sm-4 col-form-label fw-bold text-end">Estimate Location Of Emergency Occurrence:</label>
            <div class="col-sm-8">
              <input type="text" id="emergencyLocation" class="form-control" />
            </div>
          </div>
          <div class="mb-3 row align-items-center">
            <label for="emergencyExplanation" class="col-sm-4 col-form-label fw-bold text-end">Short Explanation:</label>
            <div class="col-sm-8">
              <textarea id="emergencyExplanation" class="form-control" rows="2"></textarea>
            </div>
          </div>
          <div class="mb-3 row align-items-center">
            <label for="incidentAttachment" class="col-sm-4 col-form-label fw-bold text-end">Attach Incident Report (URL):</label>
            <div class="col-sm-8">
              <input type="text" id="incidentAttachment" class="form-control" placeholder="https://..." />
            </div>
          </div>
        </div>
        <!-- Signature -->
        <div class="mb-3 row align-items-center">
          <label for="signatureName" class="col-sm-4 col-form-label fw-bold text-end">Signature Name:</label>
          <div class="col-sm-8">
            <input type="text" id="signatureName" class="form-control" required />
          </div>
        </div>
        <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-success px-5">Generate and Copy BBCode</button>
          <p id="flightCopySuccess" class="mt-2 text-success fw-semibold"></p>
        </div>
        <!-- BBCode Output -->
        <div class="mt-4">
          <label for="flightBBOutput" class="form-label fw-bold">BBCode Output:</label>
          <textarea id="flightBBOutput" class="form-control" rows="22" readonly placeholder="BBCode will appear here"></textarea>
        </div>
      </form>
    </div>
  </div>

<script>
function formatDateDDMMMYYYY(dateStr) {
  if (!dateStr) return '';
  const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
  const [year, month, day] = dateStr.split('-');
  return `${day}/${months[parseInt(month, 10) - 1]}/${year}`;
}

// Show/hide emergency section
document.querySelectorAll('input[name="emergency"]').forEach(radio => {
  radio.addEventListener('change', function() {
    document.getElementById('emergencySection').style.display =
      this.value === 'Yes' ? 'block' : 'none';
  });
});

document.getElementById('flightInfoForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const successMsg = document.getElementById('flightCopySuccess');
  successMsg.textContent = '';

  if (!this.checkValidity()) {
    this.reportValidity();
    return;
  }

  const dateRaw = document.getElementById('flightDate').value;
  const date = formatDateDDMMMYYYY(dateRaw);
  const tailNumber = document.getElementById('tailNumber').value.trim();
  const passengerList = document.getElementById('passengerList').value.trim();
  const departureTime = document.getElementById('departureTime').value.trim();
  const departureLocation = document.getElementById('departureLocation').value.trim();
  const intermittentLocations = document.getElementById('intermittentLocations').value.trim();
  const arrivalLocation = document.getElementById('arrivalLocation').value.trim();
  const cruiseAltitude = document.getElementById('cruiseAltitude').value.trim();
  const flightTime = document.getElementById('flightTime').value.trim();
  const emergency = document.querySelector('input[name="emergency"]:checked').value;
  const signatureName = document.getElementById('signatureName').value.trim();

  // Emergency fields
  let emergencySection = '';
  if (emergency === 'Yes') {
    const emergencyType = document.getElementById('emergencyType').value.trim();
    const emergencyLocation = document.getElementById('emergencyLocation').value.trim();
    const emergencyExplanation = document.getElementById('emergencyExplanation').value.trim();
    const incidentAttachment = document.getElementById('incidentAttachment').value.trim();
    emergencySection = `
[center][color=#BF0000][size=85][b]ONLY FILL THIS SECTION IF AN EMERGENCY HAPPENED[/b][/size][/color][/center]

[b]Type Of Emergency (e.g Engine Failure, Fuel Leak):[/b] ${emergencyType}

[b]Estimate Location Of Emergency Occurrence:[/b] ${emergencyLocation}

[b]Short Explanation:[/b] ${emergencyExplanation}

[b]Attach Incident Report:[/b] [url=${incidentAttachment}]**ATTACHMENT**[/url]`;
  } else {
    emergencySection = `
[center][color=#BF0000][size=85][b]ONLY FILL THIS SECTION IF AN EMERGENCY HAPPENED[/b][/size][/color][/center]

[b]Type Of Emergency (e.g Engine Failure, Fuel Leak):[/b]

[b]Estimate Location Of Emergency Occurrence:[/b]

[b]Short Explanation:[/b]

[b]Attach Incident Report:[/b] [url=]**ATTACHMENT**[/url]`;
  }

  const bbcode = `[img]https://i.imgur.com/IXMSWjH.png[/img]
[divbox=#091f62][b][color=white]1. FLIGHT INFORMATION[/color][/b][/divbox]
[divbox=white]
[list=none]
[b]Date:[/b] ${date}

[b]Aircraft Tail Number or Callsign:[/b] ${tailNumber}

[b]Passenger List:[/b] ${passengerList}

[b]Departure Time:[/b] ${departureTime} [ooc] UTC [/ooc]

[b]Departure Location:[/b] ${departureLocation}

[b]Intermittent Locations:[/b] ${intermittentLocations}

[b]Arrival Location:[/b] ${arrivalLocation}

[b]Cruise Altitude:[/b] ${cruiseAltitude} Feet

[b]Total Flight Time:[/b] ${flightTime}

[b]Emergency Reported:[/b] ${emergency}
[hr][/hr]
${emergencySection}
[hr][/hr]
[center][b]Signature:[/b]
[i] ${signatureName} [/i]
[hr][/hr]
[i][color=#FF0000][size=85]By submitting this form, I certify under penalty of law the above information is correct and accurate to the best of my knowledge.[/size][/color][/i][/center]`;

  const outputArea = document.getElementById('flightBBOutput');
  outputArea.value = bbcode.trim();
  outputArea.focus();
  outputArea.select();

  try {
    navigator.clipboard.writeText(bbcode).then(() => {
      successMsg.textContent = 'Copied to clipboard!';
    }, () => {
      successMsg.textContent = 'Failed to copy automatically. Please copy manually.';
    });
  } catch {
    successMsg.textContent = 'Clipboard API not supported. Please copy manually.';
  }
});
</script>
  </section>
  <!-- üìÑ Info Desk -->
  <section id="infodesk">
  <h2>üì¢ Public Information Desk</h2>
  <p>Access categories across the SAAA system. Use the links below for applications, logs, and certificates:</p>

  <div class="mb-5">
    <h4>üìù Registration Desk</h4>
    <ul class="list-group">
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=2955" target="_blank">Aircraft Registration</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=2956" target="_blank">Helipad Registration</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=2969" target="_blank">Airspace Authorization</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=3306" target="_blank">Aircraft Sale and Transfer</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=3517" target="_blank">Commercial Pilot License</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=3735" target="_blank">Private Flight School License</a>
      </li>
    </ul>
  </div>

  <div class="mb-5">
    <h4>‚úàÔ∏è Flight Desk</h4>
    <ul class="list-group">
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=3735" target="_blank">Registered Aircraft</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=2742" target="_blank">Pilot Flight Logs</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=3520" target="_blank">Commercial Flight Logs</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=3467" target="_blank">Demo Flight Requests</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=2584" target="_blank">Aviation Incident Reports & Complaints</a>
      </li>
    </ul>
  </div>

  <div class="mb-5">
    <h4>ü™Ç Aviation Sports Desk</h4>
    <ul class="list-group">
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=3776" target="_blank">Jumpmaster Certificate Applications</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=3780" target="_blank">Upcoming Skydive Training Sessions</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=3932" target="_blank">Skydiving Information & Resources</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=3933" target="_blank">Skydive Logs</a>
      </li>
    </ul>
  </div>

  <div class="mb-5">
    <h4>üéì Training Desk</h4>
    <ul class="list-group">
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=2952" target="_blank">Pilot License Applications</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=3422" target="_blank">Upcoming Flight School Sessions</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=3423" target="_blank">Flight School Information & Resources</a>
      </li>
      <li class="list-group-item">
        <a href="https://gov.eclipse-rp.net/viewforum.php?f=3538" target="_blank">Mechanic Course Signups</a>
      </li>
    </ul>
  </div>
  </section>

  <!-- üîê Inquiries -->
  <section id="inq">
 <h2>General Inquiries</h2>
  <ul>
    <li><strong>Administrator:</strong> Scottie Cross ‚Äì <a href="https://gov.eclipse-rp.net/ucp.php?i=pm&mode=compose&u=24784">scottiecross@sa.gov.us</a></li>
    <li><strong>Deputy Administrator:</strong> Jeremy Williams ‚Äì <a href="https://gov.eclipse-rp.net/ucp.php?i=pm&mode=compose&u=20281">jeremy.williams@sa.gov.us</a></li>
    <li><strong>Executive Aviation Official:</strong> Vacant ‚Äì <a href="#  ">vacant@sa.gov.us</a></li>
  </ul>

  <h2>Office of Flight Training Inquiries (OFT)</h2>
  <ul>
    <li><strong>Department Director:</strong> Vacant ‚Äì <a href="#">vacant@sa.gov.us</a></li>
    <li><strong>Department Deputy Director:</strong> Vacant ‚Äì <a href="#  ">vacant@sa.gov.us</a></li>
  </ul>

  <h2>Air Traffic Control Inquiries (ATC)</h2>
  <ul>
    <li><strong>Department Director:</strong> Vacant ‚Äì <a href="#">vacant@sa.gov.us</a></li>
    <li><strong>Department Deputy Director:</strong> Mick Wegman ‚Äì <a href="https://gov.eclipse-rp.net/ucp.php?i=pm&mode=compose&u=26871">Mick.Wegman@sa.gov.us</a></li>
  </ul>

  <h2>Aircraft Investigation & Accident Prevention Inquiries (AVAP)</h2>
  <ul>
    <li><strong>Department Director:</strong> Vacant ‚Äì <a href="#">vacant@sa.gov.us</a></li>
    <li><strong>Department Deputy Director:</strong> Vacant ‚Äì <a href="#">vacant@sa.gov.us</a></li>
  </ul>

  <h2>Office of Aviation Sports Inquiries (OAS)</h2>
  <ul>
    <li><strong>Department Director:</strong> Vacant ‚Äì <a href="#">vacant@sa.gov.us</a></li>
    <li><strong>Department Deputy Director:</strong> Vacant ‚Äì <a href="#">vacant@sa.gov.us</a></li>
  </ul>
  </section>

  <!-- Footer -->
  <footer>
    &copy; 2025 San Andreas Aviation Administration
  </footer>

  <!-- JavaScript -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
const SHEET_ID = "1tvBwOzrrljerW-lp1Suv9uPCutAuax67q3Ed-GWalnY";
const SHEET_NAME = "Notices"; // Change if your tab name is different
const API_KEY = "AIzaSyCTscbYmfCZ_KINIp_Z6QmHQ7J3SUQOGhk"; // <-- Replace with your real API key

    // Navigation (Single Page)
    document.querySelectorAll("[data-page]").forEach(link => {
      link.addEventListener("click", e => {
        e.preventDefault();
        document.querySelectorAll("section").forEach(sec => sec.classList.remove("active"));
        document.getElementById(link.dataset.page).classList.add("active");
      });
    });

    // Load Airport Status
    async function loadAirportStatus() {
      const container = document.getElementById("statusTable");
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}!G1:K2?key=${API_KEY}`;
      try {
        const res = await fetch(url);
        const data = await res.json();
        const rows = data.values;
        if (!rows || rows.length < 2) {
          container.innerHTML = "<p>No status data found.</p>";
          return;
        }
        let html = "<table class='table'><thead><tr>";
        rows[0].forEach(h => html += `<th>${h}</th>`);
        html += "</tr></thead><tbody><tr>";
        rows[1].forEach(s => html += `<td>${s}</td>`);
        html += "</tr></tbody></table>";
        container.innerHTML = html;
      } catch (e) {
        container.textContent = "‚ùå Error loading airport status.";
        console.error(e);
      }
    }

    // Load Notices or Trainings
    async function loadCards(targetId, range) {
      const container = document.getElementById(targetId);
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}!${range}?key=${API_KEY}`;
      try {
        const res = await fetch(url);
        const data = await res.json();
        const rows = data.values;
        if (!rows || rows.length === 0) {
          container.innerHTML = "<p>No entries yet.</p>";
          return;
        }
        container.innerHTML = "";
        rows.forEach(([title, desc]) => {
          const div = document.createElement("div");
          div.className = "notice-item";
          div.innerHTML = `<strong>${title}</strong><br>${desc}`;
          container.appendChild(div);
        });
      } catch (err) {
        container.textContent = "‚ö†Ô∏è Could not load data.";
        console.error(err);
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      loadAirportStatus();
      loadCards("noticeArea", "A3:B3");
      loadCards("noticeArea2", "A3:B");
    });
  </script>


<script>
async function loadTrainingPosts2() {
const SHEET_ID556 = "1tvBwOzrrljerW-lp1Suv9uPCutAuax67q3Ed-GWalnY";
const SHEET_NAME556 = "Notices"; // Change if your tab name is different
const API_KEY556 = "AIzaSyCTscbYmfCZ_KINIp_Z6QmHQ7J3SUQOGhk"; // <-- Replace with your real API key
  const RANGE556 = "D3:E3";                                     // Title = D, Info = E

  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID556}/values/${SHEET_NAME556}!${RANGE556}?key=${API_KEY556}`;
  const container = document.getElementById("TrainingArea2");

  try {
    const res = await fetch(url);
    const data = await res.json();
    const rows = data.values;

    if (!rows || rows.length === 0) {
      container.innerHTML = "<p>No training sessions available.</p>";
      return;
    }

    container.innerHTML = ""; // Clear container

    rows.forEach(([title, info]) => {
      // Parse info --> "Instructor: X, Time: Y, Max: Z"
      let instructor = "N/A", time = "N/A", max = "N/A";
      if (info) {
        const parts = info.split(',').map(p => p.trim());
        parts.forEach(p => {
          if (p.toLowerCase().startsWith('instructor:')) instructor = p.split('!')[1].trim();
          if (p.toLowerCase().startsWith('time:')) time = p.split('!')[1].trim();
          if (p.toLowerCase().startsWith('max')) max = p.split('!')[1].trim();
        });
      }

      // Create training card
      const block = document.createElement("div");
      block.className = "notice-item";
      block.innerHTML = `
        <strong>üìò ${title}</strong><br>
        üë®‚Äçüè´ <strong>Instructor</strong> ${instructor}<br>
        üïí <strong>Time</strong> ${time} <strong>((UTC))</strong><br>
        üë• <strong>Maximum Students:</strong> ${max}
      `;
      container.appendChild(block);
    });

  } catch (err) {
    console.error("Error loading training posts:", err);
    container.innerHTML = "‚ö†Ô∏è Failed to load training posts.";
  }
}

document.addEventListener("DOMContentLoaded", () => {
  loadTrainingPosts2();
});
</script>

<script>
async function loadTrainingPosts() {
const SHEET_ID3 = "1tvBwOzrrljerW-lp1Suv9uPCutAuax67q3Ed-GWalnY";
const SHEET_NAME3 = "Notices"; // Change if your tab name is different
const API_KEY3 = "AIzaSyCTscbYmfCZ_KINIp_Z6QmHQ7J3SUQOGhk"; // <-- Replace with your real API key
  const RANGE3 = "D3:E";                                     // Title = D, Info = E

  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID3}/values/${SHEET_NAME3}!${RANGE3}?key=${API_KEY3}`;
  const container = document.getElementById("TrainingArea");

  try {
    const res = await fetch(url);
    const data = await res.json();
    const rows = data.values;

    if (!rows || rows.length === 0) {
      container.innerHTML = "<p>No training sessions available.</p>";
      return;
    }

    container.innerHTML = ""; // Clear container

    rows.forEach(([title, info]) => {
      // Parse info --> "Instructor: X, Time: Y, Max: Z"
      let instructor = "N/A", time = "N/A", max = "N/A";
      if (info) {
        const parts = info.split(',').map(p => p.trim());
        parts.forEach(p => {
          if (p.toLowerCase().startsWith('instructor')) instructor = p.split('!')[1].trim();
          if (p.toLowerCase().startsWith('time')) time = p.split('!')[1].trim();
          if (p.toLowerCase().startsWith('max')) max = p.split('!')[1].trim();
        });
      }

      // Create training card
      const block = document.createElement("div");
      block.className = "notice-item";
      block.innerHTML = `
        <strong>üìò ${title}</strong><br>
        üë®‚Äçüè´ <strong>Instructor:</strong> ${instructor}<br>
        üïí <strong>Time:</strong> ${time} <strong>((UTC))</strong><br>
        üë• <strong>Maximum Students:</strong> ${max}
      `;
      container.appendChild(block);
    });

  } catch (err) {
    console.error("Error loading training posts:", err);
    container.innerHTML = "‚ö†Ô∏è Failed to load training posts.";
  }
}

document.addEventListener("DOMContentLoaded", () => {
  loadTrainingPosts();
});
</script>



</body>
</html>
